<%= render_navbar_for('邀请朋友得优惠', 
{ icon: 'fa fa-angle-left', link: "#{settings_wechat_shop_user_path}" }) %>

<a href="javascript:;" onclick="share()">邀请朋友</a>

<% content_for :scripts do %>
<script>

var imgUrl = "https://nj.afterwind.cn/uploads/category/image/1/small_2c7ac056-f6a0-4439-bc45-4273f9d6b2b8.jpg";
  var lineLink = "https://www.baidu.com/";
  var descContent = "描述";
  var shareTitle = '标题';
  var appid = '';
  function shareFriend() {
   WeixinJSBridge.invoke('sendAppMessage',{
    "appid": appid,
    "img_url": imgUrl,
    "img_width": "200",
    "img_height": "200",
    "link": lineLink,
    "desc": descContent,
    "title": shareTitle
   }, function(res) {
    //_report('send_msg', res.err_msg);
   })
  }
  function shareTimeline() {
   WeixinJSBridge.invoke('shareTimeline',{
    "img_url": imgUrl,
    "img_width": "200",
    "img_height": "200",
    "link": lineLink,
    "desc": descContent,
    "title": shareTitle
   }, function(res) {
     //_report('timeline', res.err_msg);
   });
  }
  function shareWeibo() {
   WeixinJSBridge.invoke('shareWeibo',{
    "content": descContent,
    "url": lineLink,
   }, function(res) {
    //_report('weibo', res.err_msg);
   });
  }
  // 当微信内置浏览器完成内部初始化后会触发WeixinJSBridgeReady事件。
  document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
   // 发送给好友
   WeixinJSBridge.on('menu:share:appmessage', function(argv){
    shareFriend();
   });
   // 分享到朋友圈
   WeixinJSBridge.on('menu:share:timeline', function(argv){
    shareTimeline();
   });
   // 分享到微博
   WeixinJSBridge.on('menu:share:weibo', function(argv){
    shareWeibo();
   });
  }, false);

// function share() {
  // WeixinJSBridge.invoke('shareTimeline',{
  //     "img_url":'https://www.baidu.com/',
  //     //"img_width":"640",
  //     //"img_height":"640",
  //     "link":'https://www.baidu.com/',
  //     "desc": 'test',
  //     "title": 'this is title'
  //   });
  // wx.onMenuShareAppMessage({
  //     title: 'test', // 分享标题
  //     desc: 'ddd', // 分享描述
  //     link: 'https://www.baidu.com', // 分享链接
  //     imgUrl: '', // 分享图标
  //     type: '', // 分享类型,music、video或link，不填默认为link
  //     dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
  //     success: function () { 
  //         // 用户确认分享后执行的回调函数
  //         console.log('success');
  //     },
  //     cancel: function () { 
  //         // 用户取消分享后执行的回调函数
  //         console.log('cancel');
  //     }
  // });
// }
</script>
<% end %>