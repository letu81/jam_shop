<% if @allow_commit %>
  <% if @success %>
  alert('<%= @unified_order_success %>);
    <% if @unified_order_success %>
      alert('123');
      wx.chooseWXPay({
        timestamp: <%= @jsapi_params[:timeStamp] %>,
        nonceStr: '<%= @jsapi_params[:nonceStr] %>',
        package: '<%= @jsapi_params[:package] %>',
        signType: '<%= @jsapi_params[:signType] %>',
        paySign: '<%= @jsapi_params[:paySign] %>',
        success: function (res) {
          // 支付成功后的回调函数
          console.log(res);
        }
      });
    <% else %>
      alert('234');
      window.location.href = '<%= wechat_shop_orders_path %>';
    <% end %>
  <% else %>
    App.alert('提交订单失败', '.new-order');
  <% end %>
<% else %>
  App.alert('地址不能为空', '.new-order');
<% end %>