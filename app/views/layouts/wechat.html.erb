<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no,width=device-width,height=device-height">
  <title><%= render_page_title %></title>
  <%= stylesheet_link_tag 'wechat', media: 'all' %>
  
</head>
<body>
  <%= yield :navbar %>
  
  <% unless notice_message.blank? %>
  <div class="container">
    <%= notice_message %>
  </div>
  <% end %>
  
  <%= yield %>
  
  <%= content_for?(:toolbar) ? yield(:toolbar) : '' %>
  <%= content_for?(:tabbar) ? yield(:tabbar) : '' %>
  
  <script src="https://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
  <script>
  <%
    @sign_package = WX::Sign.sign_package(request.original_url)
   %>
    wx.config({
      debug: <%= @sign_package[:debug] %>,
      appId: '<%= @sign_package[:appId] %>',
      timestamp: <%= @sign_package[:timestamp] %>,
      nonceStr: '<%= @sign_package[:nonceStr] %>',
      signature: '<%= @sign_package[:signature] %>',
      jsApiList: ['chooseWXPay','onMenuShareTimeline', 'onMenuShareAppMessage', 'onMenuShareQQ', 'onMenuShareQZone','openLocation','getLocation']
      
    });
    // wx.ready(function() {
//       console.log('配置成功成功');
//     });
  </script>
  <%= javascript_include_tag 'wechat', 'data-turbolinks-track' => true %>
  <%= yield :scripts %>
</body>
</html>